<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Startup-Idea Evaluator</title>
  <style>
    body{font:16px/1.4 system-ui,sans-serif;max-width:640px;margin:40px auto}
    textarea{width:100%;height:110px}
    button{padding:.6em 1.2em;font-size:1em}
    #status{margin-top:1em;color:#888}
    #answer{white-space:pre-wrap;margin-top:1.5em;border-top:1px solid #ddd;padding-top:1em}
  </style>
</head>
<body>
  <h1>AI Startup-Idea Evaluator</h1>

  <label>Your idea</label><br>
  <textarea id="idea"></textarea><br>

  <button id="send">Evaluate</button>

  <div id="status"></div>
  <div id="answer"></div>

<script>
const SUBMIT_URL = 'https://benzh2322.app.n8n.cloud/webhook/6b09d0aa-a903-4239-a2bb-9cbff340c34a';
const RESULT_URL = 'https://benzh2322.app.n8n.cloud/webhook/a6e524b5-b6f5-452a-a7bd-82771d08c8af/result/';

document.getElementById('send').onclick = async () => {
  const idea = document.getElementById('idea').value.trim();
  if (!idea) return alert('Please type an idea first!');

  /* 1) Submit the idea */
  document.getElementById('status').textContent = 'Submitting‚Ä¶';
  const r1 = await fetch(SUBMIT_URL, {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ idea })
  });
  const { jobId } = await r1.json();
  if (!jobId) { document.getElementById('status').textContent = 'Submit failed'; return; }

  /* 2) Poll /result/{jobId} every 3 s */
  let tries = 0;
  while (tries < 120) {                         // 10 min max
    await new Promise(r => setTimeout(r, 3000));
    const r2   = await fetch(RESULT_URL + jobId);
    const json = await r2.json();

    if (json.status === 'done') {
      document.getElementById('status').textContent = 'Completed ‚úîÔ∏é';
      document.getElementById('answer').textContent =
        json.brief || JSON.stringify(json, null, 2);
      return;
    }
    if (json.status === 'working') {
      document.getElementById('status').textContent =
        `Working‚Ä¶ ( ${++tries * 3}s )`;
    } else {
      document.getElementById('status').textContent = 'Unknown job ID ü§î';
      return;
    }
  }
  document.getElementById('status').textContent = 'Timed out ‚è≥';
};
</script>
</body>
</html>
